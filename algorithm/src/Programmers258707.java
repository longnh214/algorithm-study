/**
 * @author nakhoonchoi
 * @date 2025/09/18
 * @see https://school.programmers.co.kr/learn/courses/30/lessons/258707
 * @caution
 * [ê³ ë ¤ì‚¬í•­]
 * ğŸ’¡ IDEë¥¼ ì´ìš©í•˜ì§€ ì•Šê³  ë¬¸ì œë¥¼ í’€ì—ˆë‹¤.(í”„ë¡œê·¸ë˜ë¨¸ìŠ¤ ì›¹ ë²„ì „ì—ì„œ)
 *
 * ìš°ì„  ë¸”ë™ì­ì²˜ëŸ¼ ì¹´ë“œì˜ í•©ì´ íŠ¹ì • ìˆ«ìê°€ ë˜ë„ë¡ ë§ì¶”ëŠ” ìµœëŒ€ì˜ ê²½ìš°ì˜ ìˆ˜ë¥¼ ì°¾ëŠ” ë¬¸ì œë¼ê³  ìƒê°í–ˆë‹¤.
 * ì¹´ë“œì˜ í•©ì´ ë˜ì–´ì•¼í•˜ëŠ” ìˆ«ìëŠ” ì¹´ë“œë­‰ì¹˜ì˜ í¬ê¸° + 1ì´ë¼ê³  ìƒê°í–ˆê³ , ì´ë¥¼ MAGIC_NUMBER ë¼ê³  ì¹­í•œë‹¤.
 *
 * ì´ ë¬¸ì œì—ì„œ ìƒê°í•´ì•¼í•˜ëŠ” ì ì€ í¬ê²Œ ë‘ ê°€ì§€ì˜€ë‹¤.
 * - í˜„ì¬ ì§‘í•©ì—ì„œ í•©ì´ MAGIC_NUMBERê°€ ë˜ëŠ” ì§ì„ ì–´ë–»ê²Œ ë¹¨ë¦¬ ì°¾ì„ ìˆ˜ ìˆì„ê¹Œ
 *   (ë°˜ë³µë¬¸ íƒìƒ‰ì€ ë¹„íš¨ìœ¨ì ì´ë¼ê³  ìƒê°í–ˆê¸°ì— ë‹¤ë¥¸ ë°©ë²•ì„ ìƒê°í–ˆë‹¤.)
 * - ì–´ë–»ê²Œ ë°”ë¡œ ì¹´ë“œë¥¼ ë²„ë¦´ ì§€ coinì„ ì¨ì„œ ì‚´ë¦´ ì§€(?) íŒë‹¨í•  ìˆ˜ ìˆì„ê¹Œ?
 *
 * í•˜ë‚˜ì”© ì•„ì´ë””ì–´ë¥¼ ë‚¨ê²¨ë†“ëŠ”ë‹¤.
 * ë¨¼ì € 'í˜„ì¬ ì§‘í•©ì—ì„œ í•©ì´ MAGIC_NUMBERê°€ ë˜ëŠ” ì§ì„ ì–´ë–»ê²Œ ë¹¨ë¦¬ ì°¾ì„ ìˆ˜ ìˆì„ê¹Œ'
 * ëŠ” MAGIC_NUMBER ê¸°ì¤€ìœ¼ë¡œ ë°˜ì„ ë‚˜ëˆ ì„œ ë°˜ë³´ë‹¤ ì‘ë‹¤ë©´ ìŒìˆ˜ í˜•íƒœë¡œ ìŒìˆ˜ ì§‘í•©ì— ì €ì¥,
 * ë°˜ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ë‹¤ë©´ ì–‘ìˆ˜ í˜•íƒœë¡œ ì–‘ìˆ˜ ì§‘í•©ì— ì €ì¥í–ˆë‹¤.
 * ë§Œì•½ í˜„ì¬ ì¹´ë“œê°€ 7ì¼ ë•Œ, ìŒìˆ˜ ì§‘í•©ì— -7 í˜•íƒœë¡œ ì €ì¥ëœ '6'ì˜ ê°’ì´ ìˆë‹¤ë©´
 * í˜„ì¬ ì§‘í•©ì— 7ì— ëŒ€í•œ ì§ì´ ìˆë‹¤ê³  íŒë‹¨í•  ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ ìƒê°í–ˆë‹¤.
 * ë°˜ë³µë¬¸ì„ ë°˜ë³µí•´ì„œ ì§ì„ ì°¾ëŠ” ê²ƒë³´ë‹¤ëŠ” HashSetì˜ containsê°€ ë” ë¹ ë¥´ì§€ ì•Šì„ê¹Œí•´ì„œ ì•„ì´ë””ì–´ë¥¼ ì ìš©í–ˆë‹¤.
 *
 * ê·¸ë¦¬ê³  'ì–´ë–»ê²Œ ë°”ë¡œ ì¹´ë“œë¥¼ ë²„ë¦´ ì§€ coinì„ ì¨ì„œ ì‚´ë¦´ ì§€(?) íŒë‹¨í•  ìˆ˜ ìˆì„ê¹Œ'ì¸ë°,
 * ì´ ë¶€ë¶„ì„ í•´ê²°í•˜ëŠ” ì ì´ êµ‰ì¥íˆ ì–´ë µê³ , ìƒê°í•  ë¶€ë¶„ì´ ë§ì•˜ë‹¤.
 * ê°€ì¥ ë¨¼ì € ì¤‘ìš”í•˜ê²Œ ìƒê°í•´ì•¼í•  ì ì€, 'coinì„ ì ê²Œ ì¨ì„œ ìµœëŒ€í•œ ë§ì€ ì§ì„ ë§Œë“¤ì–´ë‚´ì•¼í•œë‹¤.'ì´ë‹¤.
 *
 * í˜„ì¬ ë‚´ê°€ ê°€ì§€ê³  ìˆëŠ” ì¹´ë“œ ì§‘í•©ì´ ìˆê³ ,
 * ìƒˆë¡œìš´ ì¹´ë“œ nì„ ë½‘ì•˜ì„ ë•Œ nê³¼ íŒ¨ì—ì„œ ì§ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤ë©´ ì¦‰ì‹œ coinì„ ì¨ì„œ ì±„ìš©í–ˆë‹¤.
 * ê·¸ë¦¬ê³  ì•„ë‹ˆë¼ë©´ ë²„ë ¸ë‹¤.(ì‹¤ì œë¡œ ë²„ë¦¬ì§„ ì•Šì•˜ê³  dustì˜ ì–‘ìˆ˜ ìŒìˆ˜ ì§‘í•©ì— ë‚˜ëˆ ì„œ ì €ì¥í–ˆë‹¤. ì´ìœ ëŠ” ë’¤ì—.)
 * dust ì§‘í•©ì€ íœ´ì§€í†µì´ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤. coinì„ íš¨ìœ¨ì ìœ¼ë¡œ ì¨ì„œ ì§ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤ë©´ ì¹´ë“œë¥¼ ë³µì›í•  ê²ƒì´ë‹¤.
 *
 * -----ë¼ìš´ë“œ ì‹œì‘-----
 * 1. ì¹´ë“œë¥¼ ë½‘ëŠ”ë‹¤.(coinì´ ìˆì„ ë•Œì—ë§Œ)
 * 1-1. í˜„ì¬ ì¹´ë“œ íŒ¨ì™€ í•©ì³ì„œ ì§ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤ë©´ ì±„ìš©(costëŠ” coin 1ê°œ), ëª» ë§Œë“ ë‹¤ë©´ íœ´ì§€í†µìœ¼ë¡œ ë³´ë‚¸ë‹¤.
 *
 * 2. í•©ì¹œ ì¹´ë“œ íŒ¨ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì§ì„ ë§Œë“¤ì–´ë³¸ë‹¤.
 * 2-1. ì§ì„ ë§Œë“¤ì—ˆë‹¤ë©´ ë‹¤ìŒ ë¼ìš´ë“œ ì§„í–‰
 * 2-2. ì§ì„ ëª» ë§Œë“¤ì—ˆë‹¤ë©´ íœ´ì§€í†µì˜ ì¹´ë“œ ì¤‘ì— ì¡°í•©í•´ì„œ ì§ì„ ë§Œë“¤ì–´ë‚¼ ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤.
 *      (íœ´ì§€í†µì˜ ì¹´ë“œë¥¼ ë³µì›í•˜ëŠ” ê²ƒì€ ì´ì „ roundì—ì„œ coinìœ¼ë¡œ ì¹´ë“œë¥¼ ë²„ë¦¬ì§€ ì•Šê³  ì±„ìš©í•˜ëŠ” ê²ƒê³¼ ê°™ê¸° ë•Œë¬¸ì—
 *      coinì´ ì´ ë‘ ê°œ í•„ìš”í•˜ë‹¤.)
 *      -> ì´ ë¶€ë¶„ì€ ì½”ë“œ ì˜ˆì œ 2ë²ˆ ì°¸ê³ 
 * 3. ì§ì„ ë§Œë“  ê²ƒì´ í™•ì¸ë˜ë©´ ë‹¤ìŒ ë¼ìš´ë“œ ì§„í–‰
 *    ìµœì¢…ì ìœ¼ë¡œ ëª» ë§Œë“¤ì—ˆë‹¤ë©´ ë¼ìš´ë“œ ì¢…ë£Œ
 * -----ë¼ìš´ë“œ ë-------
 *
 * ğŸ’¡ ë¼ìš´ë“œ ì§„í–‰ ì‹œì— ì£¼ì˜í•  ì ì´ ìˆì—ˆë‹¤.
 * coinì´ ì—†ë‹¤ê³  í•´ì„œ ë¼ìš´ë“œê°€ ëë‚˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì¹´ë“œë¥¼ ëª» ë½‘ì„ ë¿ì´ë‹¤.
 * ë¼ìš´ë“œ ì¢…ë£Œ ì¡°ê±´ì€ ì¹´ë“œ íŒ¨ì—ì„œ ì§ì„ ëª» ë§Œë“¤ì—ˆì„ ë•Œë‹¤.
 *
 * ğŸ’¡ íœ´ì§€í†µì—ì„œ ì§ì„ ì°¾ì€ ê²½ìš°ëŠ” coinì„ ë‘ ê°œ ì¨ì„œ ì§ì„ ë§Œë“œëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì—
 * ìµœí›„ì— ìƒê°í•´ì•¼í•  ë¶€ë¶„ì´ë‹¤.(coinì´ ë‘ ê°œ ì´ìƒ ë‚¨ì•˜ë‹¤ë©´)
 *
 * ì²˜ìŒì— ë¬¸ì œë¥¼ ì œëŒ€ë¡œ ì´í•´í•˜ì§€ ëª»í•´ì„œ í—·ê°ˆë ¸ì§€ë§Œ ì¬ë¯¸ìˆëŠ” ë¬¸ì œì˜€ë‹¤.
 * IDE ì—†ì´ sysoutìœ¼ë¡œ ë””ë²„ê¹…í•˜ê¸°ëŠ” ì‰½ì§€ ì•Šë‹¤...
 * [ì…ë ¥ì‚¬í•­]
 * [ì¶œë ¥ì‚¬í•­]
 */
import java.util.*;
//í”„ë¡œê·¸ë˜ë¨¸ìŠ¤ <2024 KAKAO WINTER INTERNSHIP> 'n + 1 ì¹´ë“œê²Œì„'

public class Programmers258707 {
    int MAGIC_NUMBER;
    int n;
    Set<Integer> plusSet; //MAGIC_NUMBERì˜ ì ˆë°˜ ì´ìƒì„ ì–‘ìˆ˜ ê·¸ëŒ€ë¡œ ì €ì¥í•  ì§‘í•©
    Set<Integer> minusSet; //MAGIC_NUMBERì˜ ì ˆë°˜ ì•„ë˜ë¥¼ ë³´ìˆ˜ í˜•íƒœ(?)ë¡œ ì €ì¥í•  ì§‘í•©
    //MAGIC_NUMBERê°€ ì˜ˆì‹œ1ê³¼ ê°™ì´ 13ì´ê³ , 6ì´ ì¹´ë“œë¡œ ë“¤ì–´ì™”ë‹¤ë©´ -7ì´ minusSetì— ì €ì¥ëœë‹¤.
    Set<Integer> dustPlusSet; //ë²„ë¦´ ì¹´ë“œë¥¼ ìœ„ì™€ ê°™ì´ ì–‘ìˆ˜ í˜•íƒœë¡œ ì €ì¥í•  ì§‘í•©(í˜¹ì‹œ coinì— ì—¬ìœ  ìˆìœ¼ë©´ ì‚´ë¦¬ë ¤ê³ )
    Set<Integer> dustMinusSet;

    public int solution(int coin, int[] cards) {
        int answer = 1;

        MAGIC_NUMBER = cards.length + 1;
        n = cards.length;

        plusSet = new HashSet<>();
        minusSet = new HashSet<>();
        dustPlusSet = new HashSet<>();
        dustMinusSet = new HashSet<>();

        for(int i=0;i<n/3;i++){
            if(cards[i] >= (MAGIC_NUMBER / 2) + 1){
                plusSet.add(cards[i]);
            }else{
                minusSet.add(cards[i] - MAGIC_NUMBER);
            }
        }

        int curIndex = n/3;

        outer: while(true){ //í•˜ë‚˜ì˜ ë¼ìš´ë“œ
            if(curIndex == cards.length){
                break;
            }

            //ì¹´ë“œë¥¼ ë‘ ì¥ ë½‘ëŠ”ë‹¤.(ê° í•œ ì¥ ì”© ìœ íš¨í•œ ì¹´ë“œì¼ì§€ ê³„ì‚°í•´ì„œ ì±„ìš©í•œë‹¤. -> ê³„ì‚°ì„ í•œ ë²ˆ í•´ë³´ì.)
            if(coin > 0) {
                for (int i = 0; i < 2; i++) {
                    int card = cards[curIndex++];

                    if (coin == 0) {
                        continue;
                    }

                    if (isInPair(card)) {
                        if (card >= (MAGIC_NUMBER / 2) + 1) {
                            plusSet.add(card);
                        } else {
                            minusSet.add(card - MAGIC_NUMBER); //6ì´ë©´ -7ì„ ì €ì¥.
                        }
                        coin--;
                    } else {
                        if (card >= (MAGIC_NUMBER / 2) + 1) {
                            dustPlusSet.add(card);
                        } else {
                            dustMinusSet.add(card - MAGIC_NUMBER); //6ì´ë©´ -7ì„ ì €ì¥.
                        }
                    }
                }
            }

            //í˜„ì¬ ì¹´ë“œ íŒ¨ ì¤‘ ì§ì´ ë§Œë“¤ì–´ì§€ëŠ” ì§€ í™•ì¸í•œë‹¤.
            boolean flag = false;
            for(int plus : plusSet){
                if(minusSet.contains(plus * -1)){
                    plusSet.remove(plus);
                    minusSet.remove(plus * -1);

                    flag = true;
                    break;
                }
            }

            //íœ´ì§€í†µì—ì„œ ì§ì„ ë§ì¶œ ìˆ˜ ìˆì„ì§€ íŒë³„í•´ì„œ ë§ì¶œ ìˆ˜ ìˆë‹¤ë©´ flagë¥¼ trueë¡œ ë°”ê¾¼ë‹¤.
            if(!flag){
                if(coin >= 2){
                    for(int dustPlus : dustPlusSet){
                        if(dustMinusSet.contains(dustPlus * -1)){
                            answer++;
                            dustPlusSet.remove(dustPlus);
                            dustMinusSet.remove(dustPlus * -1);
                            coin -= 2;
                            continue outer;
                        }
                    }
                }else{
                    break;
                }
            }

            //ë¬´ìŠ¨ ì§“ì„ í•´ë„ ì§ì„ ë§Œë“¤ ìˆ˜ ì—†ë‹¤ë©´ ìµœì¢… round ì¢…ë£Œ.
            //ë§Œë“¤ì—ˆë‹¤ë©´ ë‹¤ìŒ ë¼ìš´ë“œ ì§„í–‰
            if(!flag){
                break;
            }else{
                answer++;
            }
        }

        return answer;
    }

    public boolean isInPair(int card){
        if(card < (MAGIC_NUMBER / 2) + 1){
            if(plusSet.contains(MAGIC_NUMBER - card)){
                return true;
            }
        }else{
            if(minusSet.contains(card * -1)){
                return true;
            }
        }

        return false;
    }
}